# TÃ­nh nÄƒng Dinh dÆ°á»¡ng & Cháº¿ Ä‘á»™ Äƒn

## ğŸ¯ CÃ¡c má»¥c tiÃªu cÃ³ sáºµn

### 1ï¸âƒ£ Giáº£m má»¡ (Fat Loss)
- **Calories**: TDEE - 500 kcal
- **Protein**: 2.2g/kg (High)
- **Carbs**: Moderate
- **Fat**: 25% (Low)
- **NÆ°á»›c**: Base + 0.5L

### 2ï¸âƒ£ TÄƒng cÆ¡ (Muscle Gain)
- **Calories**: TDEE + 400 kcal
- **Protein**: 2.5g/kg (Very High)
- **Carbs**: 45% (High)
- **Fat**: Remaining
- **NÆ°á»›c**: Base + 1.0L

### 3ï¸âƒ£ Duy trÃ¬ (Maintain)
- **Calories**: TDEE (khÃ´ng thay Ä‘á»•i)
- **Protein**: 1.8g/kg (Balanced)
- **Carbs**: 40% (Balanced)
- **Fat**: 30% (Balanced)
- **NÆ°á»›c**: Base + 0.5L

### 4ï¸âƒ£ TÄƒng sá»©c bá»n (Endurance)
- **Calories**: TDEE + 200 kcal
- **Protein**: 1.6g/kg (Moderate)
- **Carbs**: 55% (Very High)
- **Fat**: Remaining
- **NÆ°á»›c**: Base + 1.5L âš¡

### 5ï¸âƒ£ TÄƒng sá»©c máº¡nh (Strength)
- **Calories**: TDEE + 500 kcal
- **Protein**: 2.4g/kg (Very High)
- **Carbs**: 45% (High)
- **Fat**: Remaining
- **NÆ°á»›c**: Base + 1.0L

### 6ï¸âƒ£ TÄƒng cÆ¡ giáº£m má»¡ (Body Recomposition) - Má»šI!
- **Calories**: TDEE - 200 kcal (slight deficit)
- **Protein**: 2.6g/kg (Highest!)
- **Carbs**: Moderate
- **Fat**: 20% (Lowest)
- **NÆ°á»›c**: Base + 1.0L

## ğŸ’§ Water Tracker - Theo dÃµi uá»‘ng nÆ°á»›c

### Quy Ä‘á»‹nh
- **1 ly = 250ml**
- Tá»± Ä‘á»™ng tÃ­nh sá»‘ ly dá»±a trÃªn má»¥c tiÃªu lÆ°á»£ng nÆ°á»›c

### CÃ¡ch sá»­ dá»¥ng
1. Xem sá»‘ ly cáº§n uá»‘ng trong ngÃ y (vÃ­ dá»¥: 12 ly = 3L)
2. **Tap vÃ o ly** Ä‘á»ƒ Ä‘Ã¡nh dáº¥u Ä‘Ã£ uá»‘ng
3. **Tap láº¡i** Ä‘á»ƒ bá» Ä‘Ã¡nh dáº¥u
4. Progress bar hiá»ƒn thá»‹ tiáº¿n Ä‘á»™
5. NÃºt "Äáº·t láº¡i" Ä‘á»ƒ reset vá» 0

### LÆ°u trá»¯ dá»¯ liá»‡u âœ¨ Má»šI!
- **Tá»± Ä‘á»™ng lÆ°u** má»—i khi báº¡n tap vÃ o ly
- LÆ°u vÃ o **SharedPreferences** (nhanh, offline)
- LÆ°u vÃ o **Firestore** (Ä‘á»“ng bá»™, lá»‹ch sá»­ dÃ i háº¡n)
- **Tá»± Ä‘á»™ng reset** khi sang ngÃ y má»›i
- **Giá»¯ nguyÃªn** khi Ä‘Ã³ng/má»Ÿ láº¡i app (trong cÃ¹ng ngÃ y)

### Hiá»ƒn thá»‹
- âœ… **Ly Ä‘Ã£ uá»‘ng**: MÃ u xanh dÆ°Æ¡ng, icon Ä‘áº§y
- â¬œ **Ly chÆ°a uá»‘ng**: MÃ u tráº¯ng, icon rá»—ng
- Sá»‘ thá»© tá»± hiá»ƒn thá»‹ á»Ÿ má»—i ly (1, 2, 3,...)

### Thá»‘ng kÃª tuáº§n ğŸ“Š
- **Tá»•ng sá»‘ ly**: Tá»•ng cá»™ng 7 ngÃ y
- **NgÃ y Ä‘áº¡t má»¥c tiÃªu**: X/7 ngÃ y Ä‘áº¡t 100%
- Hiá»ƒn thá»‹ á»Ÿ card mini dÆ°á»›i water tracker

### Lá»‹ch sá»­ 7 ngÃ y ğŸ“…
- Tap icon **History** á»Ÿ AppBar
- Xem chi tiáº¿t 7 ngÃ y gáº§n nháº¥t:
  - Sá»‘ ly Ä‘Ã£ uá»‘ng
  - Tá»•ng lÃ­t / Má»¥c tiÃªu
  - % hoÃ n thÃ nh (xanh náº¿u â‰¥100%, cam náº¿u <100%)
- **HÃ´m nay** Ä‘Æ°á»£c highlight mÃ u xanh

## ğŸ”„ Thay Ä‘á»•i má»¥c tiÃªu linh Ä‘á»™ng

### CÃ¡ch thá»±c hiá»‡n âœ¨ Cáº¢I TIáº¾N!
1. **Xem má»¥c tiÃªu hiá»‡n táº¡i**: Hiá»ƒn thá»‹ ngay dÆ°á»›i tÃªn user (badge nhá» gá»n)
2. **Tap vÃ o badge** hoáº·c tap nÃºt **"Äá»•i má»¥c tiÃªu"** (Floating Action Button)
3. **Modal bottom sheet** hiá»‡n ra vá»›i:
   - 5 má»¥c tiÃªu Ä‘áº§y Ä‘á»§ mÃ´ táº£
   - Icon vÃ  mÃ u sáº¯c riÃªng
   - MÃ´ táº£ ngáº¯n gá»n tá»«ng má»¥c tiÃªu
   - ÄÃ¡nh dáº¥u má»¥c tiÃªu Ä‘ang chá»n
4. **Tap vÃ o má»¥c tiÃªu** â†’ Tá»± Ä‘á»™ng:
   - Cáº­p nháº­t táº¥t cáº£ chá»‰ sá»‘
   - ÄÃ³ng modal
   - Hiá»ƒn thá»‹ SnackBar xÃ¡c nháº­n
   - Badge cáº­p nháº­t mÃ u sáº¯c

### Giao diá»‡n
- **Badge má»¥c tiÃªu**: Hiá»ƒn thá»‹ á»Ÿ User Info Card
  - Icon + Text + Icon Edit
  - MÃ u sáº¯c theo má»¥c tiÃªu
  - Tap Ä‘á»ƒ má»Ÿ modal
- **Floating Action Button**: GÃ³c dÆ°á»›i bÃªn pháº£i
  - Icon cá» + Text "Äá»•i má»¥c tiÃªu"
  - MÃ u xanh dÆ°Æ¡ng
- **Modal Bottom Sheet**: 
  - Header vá»›i icon vÃ  tiÃªu Ä‘á»
  - MÃ´ táº£ ngáº¯n
  - Danh sÃ¡ch 5 má»¥c tiÃªu
  - Má»¥c tiÃªu Ä‘ang chá»n Ä‘Æ°á»£c highlight
  - Animation mÆ°á»£t mÃ 

## ğŸ“Š Giao diá»‡n má»›i âœ¨ Cáº¢I TIáº¾N!

### Cáº¥u trÃºc
1. **User Info Card**: 
   - Avatar, tÃªn, tuá»•i
   - **Badge má»¥c tiÃªu** (nhá» gá»n, cÃ³ thá»ƒ tap)
   - Chiá»u cao, cÃ¢n náº·ng, BMI
2. **Nutrition Stats**: Calories, BMR, TDEE
3. **Water Tracker**: Progress bar + Grid cÃ¡c ly nÆ°á»›c
4. **Water Weekly Stats**: Tá»•ng ly tuáº§n + NgÃ y Ä‘áº¡t má»¥c tiÃªu
5. **Macros Card**: Protein, Carbs, Fat vá»›i progress bars
6. **Tips Card**: Gá»£i Ã½ dinh dÆ°á»¡ng theo má»¥c tiÃªu
7. **Floating Action Button**: NÃºt "Äá»•i má»¥c tiÃªu" (gÃ³c dÆ°á»›i pháº£i)

### Äiá»ƒm khÃ¡c biá»‡t
- âœ… **Gá»n gÃ ng hÆ¡n**: KhÃ´ng cÃ²n card lá»›n chá»n má»¥c tiÃªu
- âœ… **UX tá»‘t hÆ¡n**: Má»¥c tiÃªu hiáº¿m khi Ä‘á»•i, nÃªn chá»‰ hiá»‡n badge
- âœ… **Dá»… truy cáº­p**: 2 cÃ¡ch Ä‘á»ƒ Ä‘á»•i (badge + FAB)
- âœ… **Modal Ä‘áº¹p**: Bottom sheet vá»›i mÃ´ táº£ chi tiáº¿t

## ğŸ¨ MÃ u sáº¯c

- **Giáº£m má»¡**: ğŸ”´ Äá»
- **TÄƒng cÆ¡**: ğŸŸ¢ Xanh lÃ¡
- **Duy trÃ¬**: ğŸŸ  Cam
- **TÄƒng sá»©c bá»n**: ğŸŸ£ TÃ­m
- **TÄƒng sá»©c máº¡nh**: ğŸ”µ Xanh Ä‘áº­m

## ğŸ’¡ LÆ°u Ã½

- Thay Ä‘á»•i má»¥c tiÃªu **chá»‰ táº¡m thá»i** trong session hiá»‡n táº¡i
- Water tracker **KHÃ”NG reset** khi Ä‘á»•i má»¥c tiÃªu (váº«n giá»¯ nguyÃªn)
- Water tracker **Tá»° Äá»˜NG RESET** khi sang ngÃ y má»›i
- Dá»¯ liá»‡u uá»‘ng nÆ°á»›c Ä‘Æ°á»£c lÆ°u:
  - **Local**: SharedPreferences (nhanh, offline)
  - **Cloud**: Firestore (lá»‹ch sá»­, Ä‘á»“ng bá»™)
- Táº¥t cáº£ tÃ­nh toÃ¡n dá»±a trÃªn cÃ´ng thá»©c khoa há»c (Mifflin-St Jeor)
- Dá»¯ liá»‡u cÅ© (>30 ngÃ y) sáº½ tá»± Ä‘á»™ng xÃ³a Ä‘á»ƒ tá»‘i Æ°u storage

## ğŸ“ Files liÃªn quan

```
lib/features/
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ nutrition_calculation_service.dart
â”‚   â””â”€â”€ water_tracking_service.dart          # Má»šI - Service lÆ°u trá»¯
â”œâ”€â”€ home/screens/
â”‚   â””â”€â”€ nutrition_screen.dart                # ÄÃ£ cáº­p nháº­t
â””â”€â”€ home/
    â””â”€â”€ NUTRITION_FEATURES.md                # File nÃ y
```

## ğŸ”¥ Firestore Structure

```
users/{userId}/water_tracking/{YYYY-MM-DD}
  â”œâ”€â”€ date: Timestamp
  â”œâ”€â”€ glasses_completed: int
  â”œâ”€â”€ total_liters: double
  â”œâ”€â”€ target_liters: double
  â”œâ”€â”€ completion_percentage: int
  â””â”€â”€ updated_at: Timestamp
```
